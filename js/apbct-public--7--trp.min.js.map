{"version":3,"file":"apbct-public--7--trp.min.js","sources":["apbct-public--7--trp.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', function() {\n    let ctTrpLocalize = undefined;\n    let ctTrpIsAdminCommentsList = false;\n\n    if ( typeof ctPublic !== 'undefined' || typeof ctTrpAdminLocalize !== 'undefined' ) {\n        if ( typeof ctPublic !== 'undefined' && ctPublic.theRealPerson ) {\n            ctTrpLocalize = ctPublic.theRealPerson;\n        }\n        if (\n            typeof ctTrpLocalize === 'undefined' &&\n            typeof ctTrpAdminLocalize !== 'undefined' &&\n            ctTrpAdminLocalize.theRealPerson\n        ) {\n            ctTrpLocalize = ctTrpAdminLocalize.theRealPerson;\n            ctTrpIsAdminCommentsList = true;\n        }\n    }\n\n    if ( ! ctTrpLocalize ) {\n        return;\n    }\n\n    // Selectors. Try to handle the WIDE range of themes.\n    let themesCommentsSelector = '.apbct-trp *[class*=\"comment-author\"]';\n    let woocommerceReviewsSelector = '.apbct-trp *[class*=\"review__author\"]';\n    let adminCommentsListSelector = '.apbct-trp td[class*=\"column-author\"] > strong';\n    const trpComments = document.querySelectorAll(\n        themesCommentsSelector + ',' +\n        woocommerceReviewsSelector + ',' +\n        adminCommentsListSelector);\n\n    if ( trpComments.length === 0 ) {\n        return;\n    }\n\n    trpComments.forEach(( element, index ) => {\n        if ( element.classList.contains('comment-author-link') ) {\n            return;\n        }\n        let trpLayout = document.createElement('div');\n        trpLayout.setAttribute('class', 'apbct-real-user-badge');\n\n        let trpImage = document.createElement('img');\n        trpImage.setAttribute('src', ctTrpLocalize.imgPersonUrl);\n        trpImage.setAttribute('class', 'apbct-real-user-popup-img');\n\n        let trpDescription = document.createElement('div');\n        trpDescription.setAttribute('class', 'apbct-real-user-popup');\n\n        let trpDescriptionHeading = document.createElement('p');\n        trpDescriptionHeading.setAttribute('class', 'apbct-real-user-popup-header');\n        trpDescriptionHeading.append(ctTrpLocalize.phrases.trpHeading);\n\n        let trpDescriptionContent = document.createElement('div');\n        trpDescriptionContent.setAttribute('class', 'apbct-real-user-popup-content_row');\n\n        let trpDescriptionContentSpan = document.createElement('span');\n        trpDescriptionContentSpan.append(ctTrpLocalize.phrases.trpContent1 + ' ');\n        trpDescriptionContentSpan.append(ctTrpLocalize.phrases.trpContent2);\n\n        if ( ctTrpIsAdminCommentsList ) {\n            let learnMoreLink = document.createElement('a');\n            learnMoreLink.setAttribute('href', ctTrpLocalize.trpContentLink);\n            learnMoreLink.setAttribute('target', '_blank');\n            learnMoreLink.text = ctTrpLocalize.phrases.trpContentLearnMore;\n            trpDescriptionContentSpan.append(' '); // Need one space\n            trpDescriptionContentSpan.append(learnMoreLink);\n        }\n\n        trpDescriptionContent.append(trpDescriptionContentSpan);\n        trpDescription.append(trpDescriptionHeading, trpDescriptionContent);\n        trpLayout.append(trpImage);\n        element.append(trpLayout);\n        element.append(trpDescription);\n    });\n\n    const badges = document.querySelectorAll('.apbct-real-user-badge');\n\n    badges.forEach((badge) => {\n        let hideTimeout = undefined;\n\n        badge.addEventListener('click', function() {\n            const popup = this.nextElementSibling;\n            if (popup && popup.classList.contains('apbct-real-user-popup')) {\n                popup.classList.toggle('visible');\n            }\n        });\n\n        badge.addEventListener('mouseenter', function() {\n            const popup = this.nextElementSibling;\n            if (popup && popup.classList.contains('apbct-real-user-popup')) {\n                popup.classList.add('visible');\n            }\n        });\n\n        badge.addEventListener('mouseleave', function() {\n            hideTimeout = setTimeout(() => {\n                const popup = this.nextElementSibling;\n                if (popup && popup.classList.contains('apbct-real-user-popup')) {\n                    popup.classList.remove('visible');\n                }\n            }, 1000);\n        });\n\n        const popup = badge.nextElementSibling;\n        popup.addEventListener('mouseenter', function() {\n            clearTimeout(hideTimeout);\n            popup.classList.add('visible');\n        });\n\n        popup.addEventListener('mouseleave', function() {\n            hideTimeout = setTimeout(() => {\n                if (popup.classList.contains('apbct-real-user-popup')) {\n                    popup.classList.remove('visible');\n                }\n            }, 1000);\n        });\n\n        // For mobile devices\n        badge.addEventListener('touchend', function() {\n            hideTimeout = setTimeout(() => {\n                const popup = this.nextElementSibling;\n                const selection = window.getSelection();\n                // Check if no text is selected\n                if (popup && selection && popup.classList.contains('apbct-real-user-popup') &&\n                    selection.toString().length === 0\n                ) {\n                    popup.classList.remove('visible');\n                } else {\n                    clearTimeout(hideTimeout);\n                    document.addEventListener('selectionchange', function onSelectionChange() {\n                        const selection = window.getSelection();\n                        if (selection && selection.toString().length === 0) {\n                            // Restart the hide timeout when selection is cleared\n                            hideTimeout = setTimeout(() => {\n                                const popup = badge.nextElementSibling;\n                                if (popup && popup.classList.contains('apbct-real-user-popup')) {\n                                    popup.classList.remove('visible');\n                                }\n                            }, 3000);\n                            document.removeEventListener('selectionchange', onSelectionChange);\n                        }\n                    });\n                }\n            }, 3000);\n        });\n    });\n});\n"],"names":["document","addEventListener","let","ctTrpLocalize","undefined","ctTrpIsAdminCommentsList","trpComments","ctPublic","ctTrpAdminLocalize","theRealPerson","querySelectorAll","themesCommentsSelector","length","forEach","element","index","trpLayout","trpImage","trpDescription","trpDescriptionHeading","trpDescriptionContent","trpDescriptionContentSpan","learnMoreLink","classList","contains","createElement","setAttribute","imgPersonUrl","append","phrases","trpHeading","trpContent1","trpContent2","trpContentLink","text","trpContentLearnMore","hideTimeout","badge","popup","this","nextElementSibling","toggle","add","setTimeout","remove","clearTimeout","selection","window","getSelection","toString","onSelectionChange","removeEventListener"],"mappings":"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"}
{"version":3,"file":"apbct-public--7--trp.min.js","sources":["apbct-public--7--trp.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', function() {\r\n    let ctTrpLocalize = undefined;\r\n    let ctTrpIsAdminCommentsList = false;\r\n\r\n    if ( typeof ctPublic !== 'undefined' || typeof ctTrpAdminLocalize !== 'undefined' ) {\r\n        if ( typeof ctPublic !== 'undefined' && ctPublic.theRealPerson ) {\r\n            ctTrpLocalize = ctPublic.theRealPerson;\r\n        }\r\n        if (\r\n            typeof ctTrpLocalize === 'undefined' &&\r\n            typeof ctTrpAdminLocalize !== 'undefined' &&\r\n            ctTrpAdminLocalize.theRealPerson\r\n        ) {\r\n            ctTrpLocalize = ctTrpAdminLocalize.theRealPerson;\r\n            ctTrpIsAdminCommentsList = true;\r\n        }\r\n    }\r\n\r\n    if ( ! ctTrpLocalize ) {\r\n        return;\r\n    }\r\n\r\n    // Selectors. Try to handle the WIDE range of themes.\r\n    let themesCommentsSelector = '.apbct-trp *[class*=\"comment-author\"]';\r\n    if ( document.querySelector('.apbct-trp .comment-author .comment-author-link') ) {\r\n        // For Spacious theme\r\n        themesCommentsSelector = '.apbct-trp *[class*=\"comment-author-link\"]';\r\n    }\r\n    let woocommerceReviewsSelector = '.apbct-trp *[class*=\"review__author\"]';\r\n    let adminCommentsListSelector = '.apbct-trp td[class*=\"column-author\"] > strong';\r\n    const trpComments = document.querySelectorAll(\r\n        themesCommentsSelector + ',' +\r\n        woocommerceReviewsSelector + ',' +\r\n        adminCommentsListSelector);\r\n\r\n    if ( trpComments.length === 0 ) {\r\n        return;\r\n    }\r\n\r\n    trpComments.forEach(( element, index ) => {\r\n        let trpLayout = document.createElement('div');\r\n        trpLayout.setAttribute('class', 'apbct-real-user-badge');\r\n\r\n        let trpImage = document.createElement('img');\r\n        trpImage.setAttribute('src', ctTrpLocalize.imgPersonUrl);\r\n        trpImage.setAttribute('class', 'apbct-real-user-popup-img');\r\n\r\n        let trpDescription = document.createElement('div');\r\n        trpDescription.setAttribute('class', 'apbct-real-user-popup');\r\n\r\n        let trpDescriptionHeading = document.createElement('p');\r\n        trpDescriptionHeading.setAttribute('class', 'apbct-real-user-popup-header');\r\n        trpDescriptionHeading.append(ctTrpLocalize.phrases.trpHeading);\r\n\r\n        let trpDescriptionContent = document.createElement('div');\r\n        trpDescriptionContent.setAttribute('class', 'apbct-real-user-popup-content_row');\r\n\r\n        let trpDescriptionContentSpan = document.createElement('span');\r\n        trpDescriptionContentSpan.append(ctTrpLocalize.phrases.trpContent1 + ' ');\r\n        trpDescriptionContentSpan.append(ctTrpLocalize.phrases.trpContent2);\r\n\r\n        if ( ctTrpIsAdminCommentsList ) {\r\n            let learnMoreLink = document.createElement('a');\r\n            learnMoreLink.setAttribute('href', ctTrpLocalize.trpContentLink);\r\n            learnMoreLink.setAttribute('target', '_blank');\r\n            learnMoreLink.text = ctTrpLocalize.phrases.trpContentLearnMore;\r\n            trpDescriptionContentSpan.append(' '); // Need one space\r\n            trpDescriptionContentSpan.append(learnMoreLink);\r\n        }\r\n\r\n        trpDescriptionContent.append(trpDescriptionContentSpan);\r\n        trpDescription.append(trpDescriptionHeading, trpDescriptionContent);\r\n        trpLayout.append(trpImage);\r\n        element.append(trpLayout);\r\n        element.append(trpDescription);\r\n    });\r\n\r\n    const badges = document.querySelectorAll('.apbct-real-user-badge');\r\n\r\n    badges.forEach((badge) => {\r\n        let hideTimeout = undefined;\r\n\r\n        badge.addEventListener('click', function() {\r\n            const popup = this.nextElementSibling;\r\n            if (popup && popup.classList.contains('apbct-real-user-popup')) {\r\n                popup.classList.toggle('visible');\r\n            }\r\n        });\r\n\r\n        badge.addEventListener('mouseenter', function() {\r\n            const popup = this.nextElementSibling;\r\n            if (popup && popup.classList.contains('apbct-real-user-popup')) {\r\n                popup.classList.add('visible');\r\n            }\r\n        });\r\n\r\n        badge.addEventListener('mouseleave', function() {\r\n            hideTimeout = setTimeout(() => {\r\n                const popup = this.nextElementSibling;\r\n                if (popup && popup.classList.contains('apbct-real-user-popup')) {\r\n                    popup.classList.remove('visible');\r\n                }\r\n            }, 1000);\r\n        });\r\n\r\n        const popup = badge.nextElementSibling;\r\n        popup.addEventListener('mouseenter', function() {\r\n            clearTimeout(hideTimeout);\r\n            popup.classList.add('visible');\r\n        });\r\n\r\n        popup.addEventListener('mouseleave', function() {\r\n            hideTimeout = setTimeout(() => {\r\n                if (popup.classList.contains('apbct-real-user-popup')) {\r\n                    popup.classList.remove('visible');\r\n                }\r\n            }, 1000);\r\n        });\r\n\r\n        // For mobile devices\r\n        badge.addEventListener('touchend', function() {\r\n            hideTimeout = setTimeout(() => {\r\n                const popup = this.nextElementSibling;\r\n                const selection = window.getSelection();\r\n                // Check if no text is selected\r\n                if (popup && selection && popup.classList.contains('apbct-real-user-popup') &&\r\n                    selection.toString().length === 0\r\n                ) {\r\n                    popup.classList.remove('visible');\r\n                } else {\r\n                    clearTimeout(hideTimeout);\r\n                    document.addEventListener('selectionchange', function onSelectionChange() {\r\n                        const selection = window.getSelection();\r\n                        if (selection && selection.toString().length === 0) {\r\n                            // Restart the hide timeout when selection is cleared\r\n                            hideTimeout = setTimeout(() => {\r\n                                const popup = badge.nextElementSibling;\r\n                                if (popup && popup.classList.contains('apbct-real-user-popup')) {\r\n                                    popup.classList.remove('visible');\r\n                                }\r\n                            }, 3000);\r\n                            document.removeEventListener('selectionchange', onSelectionChange);\r\n                        }\r\n                    });\r\n                }\r\n            }, 3000);\r\n        });\r\n    });\r\n});\r\n"],"names":["document","addEventListener","let","ctTrpLocalize","undefined","ctTrpIsAdminCommentsList","ctPublic","ctTrpAdminLocalize","theRealPerson","themesCommentsSelector","querySelector","trpComments","querySelectorAll","length","forEach","element","index","learnMoreLink","trpLayout","createElement","trpImage","setAttribute","trpDescription","imgPersonUrl","trpDescriptionHeading","trpDescriptionContent","append","phrases","trpHeading","trpDescriptionContentSpan","trpContent1","trpContent2","trpContentLink","text","trpContentLearnMore","hideTimeout","popup","badge","this","nextElementSibling","classList","contains","toggle","add","setTimeout","remove","clearTimeout","selection","window","getSelection","toString","onSelectionChange","removeEventListener"],"mappings":"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"}
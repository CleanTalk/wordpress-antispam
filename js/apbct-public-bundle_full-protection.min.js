function ctProtectExternal(){for(let e=0;e<document.forms.length;e++)if(void 0===document.forms[e].cleantalk_hidden_action&&void 0===document.forms[e].cleantalk_hidden_method){var t,n=document.forms[e];if(!formIsExclusion(n))if(isIntegratedForm(n))apbctProcessExternalForm(n,e,document);else if(void 0!==n.dataset.mailingListId||"string"==typeof n.action&&-1!==n.action.indexOf("webto.salesforce.com")||"string"==typeof n.action&&n.querySelector('[href*="activecampaign"]'))apbctProcessExternalFormByFakeButton(n,e,document);else if("string"==typeof n.action&&(-1!==n.action.indexOf("http://")||-1!==n.action.indexOf("https://"))){let e=n.action.split("//");(e=e[1].split("/"))[0].toLowerCase()!==location.hostname.toLowerCase()&&((t=document.createElement("input")).name="cleantalk_hidden_action",t.value=n.action,t.type="hidden",n.appendChild(t),(t=document.createElement("input")).name="cleantalk_hidden_method",t.value=n.method,t.type="hidden",n.method="POST",n.appendChild(t),n.action=document.location)}}apbctProcessIframes(),ctStartFieldsListening()}function formIsExclusion(o){let c=!1;try{o.parentElement&&0<o.parentElement.classList.length&&-1!==o.parentElement.classList[0].indexOf("mewtwo")&&(c=!0),null!==o.getAttribute("action")&&["paypal.com/cgi-bin/webscr"].forEach(function(e){-1!==o.getAttribute("action").indexOf(e)&&(c=!0)}),["give-form","frmCalc","ihf-contact-request-form","wpforms"].forEach(function(e){var t=o.getAttribute("id");null!=t&&-1!==t.indexOf(e)&&(c=!0)}),["search-form","hs-form","ihc-form-create-edit","nf-form-content","elementor-form","wpforms","et_pb_searchform"].forEach(function(e){let t="";var n=t=o.getAttribute("class")?o.getAttribute("class"):apbctGetFormClass(o,e);null!=n&&-1!==n.indexOf(e)&&(c=!0)}),["search"].forEach(function(e){var t=o.getAttribute("id");null!=t&&-1!==t.indexOf(e)&&(c=!0)})}catch(e){console.table("APBCT ERROR: formIsExclusion() - ",e)}return c}function apbctGetFormClass(e,t){if("object"==typeof e&&e.querySelector("."+t))return t}function apbctProcessIframes(){var n=document.getElementsByTagName("iframe");if(0<n.length)for(let t=0;t<n.length;t++)if(null!=n[t].contentDocument){var o=n[t].contentDocument.forms;if(0!==o.length)for(let e=0;e<o.length;e++){var c=o[e];formIsExclusion(c)||apbctProcessExternalForm(c,e,n[t].contentDocument)}}}function apbctProcessExternalForm(e,t,n){var o=document.createElement("i"),o=(o.className="cleantalk_placeholder",o.style="display: none",e.parentElement.insertBefore(o,e),e.previousSibling),c=e.outerHTML,a=e,e=(e.parentElement.removeChild(e),document.createElement("div")),c=(e.innerHTML=c,o.after(e.firstElementChild),document.createElement("input"));c.name="action",c.value="cleantalk_force_ajax_check",c.type="hidden";let i=n.forms[t],r=(i.appendChild(c),i.apbctPrev=o,i.apbctFormOriginal=a,!1);void 0!==i.classList&&["newsletterform","ml-block-form"].forEach(function(e){i.classList.contains(e)&&(r=e)});e=null;r?null!=(e=i.querySelector('button[type="submit"]'))&&e.addEventListener("click",function(e){e.preventDefault(),sendAjaxCheckingFormData(i)}):n.forms[t].onsubmit=function(e){e.preventDefault(),sendAjaxCheckingFormData(e.currentTarget)}}function apbctProcessExternalFormByFakeButton(e,t,n){var o,c,a,i=e.querySelector('[type="submit"]'),e=e.querySelector('[type="submit"]').form.onsubmit;i&&(o=i.parentElement,c=i.outerHTML,i.remove(),(a=document.createElement("div")).innerHTML=c,o.appendChild(a.firstElementChild),(c=document.createElement("input")).name="action",c.value="cleantalk_force_ajax_check",c.type="hidden",(a=n.forms[t]).appendChild(c),a.apbctParent=o,a.submitButtonOriginal=i,a.onsubmitOriginal=e,n.forms[t].onsubmit=function(e){e.preventDefault(),sendAjaxCheckingFormData(e.currentTarget)})}function apbctReplaceInputsValuesFromOtherForm(e,t){var n=e.querySelectorAll("button, input, textarea, select");let o=t.querySelectorAll("button, input, textarea, select");-1!==e.outerHTML.indexOf('action="https://www.kulahub.net')||isFormHasDiviRedirect(e)||-1!==e.outerHTML.indexOf('class="et_pb_contact_form')?n.forEach(t=>{o.forEach(e=>{t.name===e.name&&("checkbox"===e.type||"radio"===e.type?e.checked=apbctVal(t):e.value=apbctVal(t))})}):n.forEach(t=>{o.forEach(e=>{t.outerHTML===e.outerHTML&&("checkbox"===e.type||"radio"===e.type?e.checked=apbctVal(t):e.value=apbctVal(t))})})}function ctProtectKlaviyoForm(){if(document.querySelector('link[rel="dns-prefetch"][href="//static.klaviyo.com"]')){let t=setInterval(()=>{var e=document.querySelectorAll("form.klaviyo-form");e.length&&(clearInterval(t),e.forEach((e,t)=>{apbctProcessExternalFormKlaviyo(e,t,document)}))},500)}}function apbctProcessExternalFormKlaviyo(t,e,n){var o,c=t.querySelector('button[type="button"].needsclick');c&&(c.disabled=!0,(o=document.createElement("input")).name="action",o.value="cleantalk_force_ajax_check",o.type="hidden",t.appendChild(o),(o=document.createElement("div")).id="apbct-klaviyo-cover",o.style.width="100%",o.style.height="100%",o.style.background="black",o.style.opacity=0,o.style.position="absolute",o.style.top=0,o.style.cursor="pointer",o.onclick=function(e){sendAjaxCheckingFormData(t)},c.parentNode.style.position="relative",c.parentNode.appendChild(o))}function ctProtectOutsideIframe(){var e=document.querySelectorAll("iframe");0<e.length&&e.forEach(function(e){!(-1!==e.src.indexOf("form.typeform.com")||-1!==e.src.indexOf("forms.zohopublic.com")||-1!==e.src.indexOf("link.surepathconnect.com")||e.classList.contains("hs-form-iframe")||-1!==e.src.indexOf("facebook.com")&&-1!==e.src.indexOf("plugins/comments.php"))||!1!==apbctLocalStorage.get("apbct_iframes_protected")&&0<apbctLocalStorage.get("apbct_iframes_protected").length&&void 0!==e.id&&-1!==apbctLocalStorage.get("apbct_iframes_protected").indexOf[e.id]||ctProtectOutsideIframeHandler(e)})}apbctLocalStorage.set("apbct_iframes_protected",[]),window.onload=function(){+ctPublic.settings__forms__check_external&&(setTimeout(function(){ctProtectExternal(),catchDynamicRenderedForm(),catchNextendSocialLoginForm(),ctProtectOutsideIframe()},2e3),ctProtectKlaviyoForm())};let ctProtectOutsideIframeCheck;function ctProtectOutsideIframeHandler(e){var t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.background="black",t.style.opacity=0,t.style.position="absolute",t.style.top=0,t.onclick=function(t){if(void 0===ctProtectOutsideIframeCheck){var t=t.currentTarget,n=(t.style.opacity=.5,document.createElement("div"));n.className="apbct-iframe-preloader",t.appendChild(n);let e="";document.querySelector('[name*="ct_bot_detector_event_token"]')&&(e=document.querySelector('[name*="ct_bot_detector_event_token"]').value);t={action:"cleantalk_outside_iframe_ajax_check",ct_no_cookie_hidden_field:getNoCookieData(),ct_bot_detector_event_token:e};apbct_public_sendAJAX(t,{async:!1,callback:function(t){!(ctProtectOutsideIframeCheck=!0)===t.apbct.blocked?document.querySelectorAll("div.apbct-iframe-preloader").forEach(function(e){e.parentNode.remove()}):(document.querySelectorAll("div.apbct-iframe-preloader").forEach(e=>{e.parentNode.style.color="white",e.parentNode.innerHTML+=t.apbct.comment}),document.querySelectorAll("div.apbct-iframe-preloader").forEach(e=>{e.remove()}))}})}},e.parentNode.style.position="relative",e.parentNode.appendChild(t);let n=apbctLocalStorage.get("apbct_iframes_protected");!1===n&&(n=[]),void 0!==e.id&&(n.push(e.id),apbctLocalStorage.set("apbct_iframes_protected",n))}function catchNextendSocialLoginForm(){var e=document.getElementById("nsl-custom-login-form-main");e&&blockBtnNextendSocialLogin(e)}function blockBtnNextendSocialLogin(e){var t=e.querySelectorAll(".nsl-container-buttons a"),e=e.querySelectorAll('a[data-plugin="nsl"] .nsl-button');t.forEach(e=>{e.setAttribute("data-oauth-login-blocked","true"),e.addEventListener("click",e=>{e.preventDefault()})}),e.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),ctCheckAjax(t)})})}function allowAjaxNextendSocialLogin(e){e.parentElement.setAttribute("data-oauth-login-blocked","false"),e.parentElement.click()}function forbiddenAjaxNextendSocialLogin(e,t){var n,e=e.parentElement;"false"==e.getAttribute("data-oauth-login-blocked")&&e.setAttribute("data-oauth-login-blocked","true"),document.querySelector(".ct-forbidden-msg")||((n=document.createElement("div")).className="ct-forbidden-msg",n.style.background="red",n.style.color="white",n.style.padding="5px",n.innerHTML=t,e.insertAdjacentElement("beforebegin",n))}function ctCheckAjax(t){var e={action:"cleantalk_nsl_ajax_check",ct_no_cookie_hidden_field:document.getElementsByName("ct_no_cookie_hidden_field")[0].value};apbct_public_sendAJAX(e,{async:!1,callback:function(e){!1===e.apbct.blocked?allowAjaxNextendSocialLogin(t):forbiddenAjaxNextendSocialLogin(t,e.apbct.comment)}})}function isIntegratedForm(e){var t="string"==typeof e.action?e.action:"",n=null!==e.getAttribute("id")?e.getAttribute("id"):"";return!!(-1!==t.indexOf("app.convertkit.com")||-1!==t.indexOf("app.kit.com")||void 0!==e.firstChild.classList&&e.firstChild.classList.contains("cb-form-group")||-1!==t.indexOf("mailerlite.com")||-1!==t.indexOf("colcolmail.co.uk")||-1!==t.indexOf("paypal.com")||-1!==t.indexOf("infusionsoft.com")||-1!==t.indexOf("secure2.convio.net")||-1!==t.indexOf("hookb.in")||-1!==t.indexOf("external.url")||-1!==t.indexOf("tp.media")||-1!==t.indexOf("flodesk.com")||-1!==t.indexOf("sendfox.com")||-1!==t.indexOf("aweber.com")||-1!==t.indexOf("secure.payu.com")||-1!==t.indexOf("mautic")||-1!==n.indexOf("mauticform_")||-1!==n.indexOf("ihf-contact-request-form")||-1!==t.indexOf("crm.zoho.com")||-1!==n.indexOf("delivra-external-form")||-1!==t.indexOf("eloqua.com")||-1!==t.indexOf("kulahub.net")||isFormHasDiviRedirect(e)||-1!==t.indexOf("eocampaign1.com")||-1!==t.indexOf("wufoo.com")||void 0!==e.classList&&e.classList.contains("sp-element-container"))}function isFormHasDiviRedirect(e){let t=!1;var n=document.querySelector('div[id^="et_pb_contact_form"]');return t="object"==typeof e&&null!==e&&null!==n&&n.hasAttribute("data-redirect_url")&&""!==n.getAttribute("data-redirect_url")&&null!==n.querySelector('form[class^="et_pb_contact_form"]')?e===n.querySelector('form[class^="et_pb_contact_form"]'):t}function sendAjaxCheckingFormData(u){var e={};e[0]=apbct_collect_visible_fields(u),apbct_visible_fields_set_cookie(e);let n={ct_bot_detector_event_token:apbctLocalStorage.get("bot_detector_event_token")};e=u.elements;(e=Array.prototype.slice.call(e)).forEach(function(e,t){""===e.name?n["input_"+t]=e.value:n[e.name]=e.value}),apbct_public_sendAJAX(n,{async:!1,callback:function(e,t,n,o){if(void 0===e.apbct||!+e.apbct.blocked){if(void 0!==u.classList&&u.classList.contains("klaviyo-form"))return(i=document.getElementById("apbct-klaviyo-cover"))&&i.remove(),void((i=u.querySelector('button[type="button"].needsclick'))&&(i.disabled=!1,i.click()));if(void 0!==u.dataset.mailingListId){let e=u.querySelector('[type="submit"]');return e.remove(),u.apbctParent.appendChild(u.submitButtonOriginal),void(e=u.querySelector('[type="submit"]')).click()}if(u.hasAttribute("action")&&-1!==u.getAttribute("action").indexOf("webto.salesforce.com")){let e=u.querySelector('[type="submit"]');return e.remove(),u.apbctParent.appendChild(u.submitButtonOriginal),u.onsubmit=u.onsubmitOriginal,void(e=u.querySelector('[type="submit"]')).click()}if(u.querySelector('[href*="activecampaign"]')){let e=u.querySelector('[type="submit"]');return e.remove(),u.apbctParent.appendChild(u.submitButtonOriginal),u.onsubmit=u.onsubmitOriginal,void(e=u.querySelector('[type="submit"]')).click()}var c,a,i=u,r=(u.parentElement.removeChild(u),u.apbctPrev),l=u.apbctFormOriginal;let e=!1;apbctReplaceInputsValuesFromOtherForm(i,l),-1!==l.id.indexOf("mautic")&&(e=!0),r.after(l);for(c of l.querySelectorAll('input[name="apbct_visible_fields"]'))c.remove();for(a of l.querySelectorAll('input[value="cleantalk_force_ajax_check"]'))a.remove();let t=l.querySelectorAll("button[type=submit]");if(0!==t.length)return t[0].click(),void(e&&setTimeout(function(){ctProtectExternal()},1500));if(0!==(t=l.querySelectorAll("input[type=submit]")).length)return void t[0].click();if(0!==(t=l.querySelectorAll('button[data-element="submit"]')).length)return void t[0].click();0!==(t=l.querySelectorAll('input[type="image"][name="submit"]')).length&&t[0].click()}void 0!==e.apbct&&+e.apbct.blocked&&ctParseBlockMessage(e)}})}function catchDynamicRenderedForm(){catchDynamicRenderedFormHandler(document.getElementsByTagName("form"));var t=document.getElementsByTagName("iframe");if(0<t.length)for(let e=0;e<t.length;e++)if(null!=t[e].contentDocument){var n=t[e].contentDocument.forms;if(0===n.length)return;catchDynamicRenderedFormHandler(n,t[e].contentDocument)}}function catchDynamicRenderedFormHandler(e,t=document){var n,o,c=[];for(n of e){var a=n.getAttribute("id");a&&-1!==a.indexOf("hsForm")&&c.push(a),a&&-1!==a.indexOf("createuser")&&void 0!==n.classList&&n.classList.contains("ihc-form-create-edit")&&c.push(a)}for(o of c){var i=t.getElementById(o);i.apbct_external_onsubmit_prev=i.onsubmit,i.onsubmit=sendAjaxCheckingDynamicFormData}}function sendAjaxCheckingDynamicFormData(a){a.preventDefault(),a.stopImmediatePropagation();let i=a;a=a.target;var e=document.createElement("input"),e=(e.name="action",e.value="cleantalk_force_ajax_check",e.type="hidden",a.appendChild(e),{});e[0]=apbct_collect_visible_fields(a),apbct_visible_fields_set_cookie(e),a.append(ctNoCookieConstructHiddenField("hidden"));let n={};e=a.elements;(e=Array.prototype.slice.call(e)).forEach(function(e,t){""===e.name?n["input_"+t]=e.value:n[e.name]=e.value}),apbct_public_sendAJAX(n,{async:!1,callback:function(e){if(void 0===e.apbct||!+e.apbct.blocked){a.onsubmit=null;for(var t of a.querySelectorAll('input[name="apbct_visible_fields"]'))t.remove();for(var n of a.querySelectorAll('input[value="cleantalk_force_ajax_check"]'))n.remove();for(var o of a.querySelectorAll('input[name="ct_no_cookie_hidden_field"]'))o.remove();a.apbct_external_onsubmit_prev instanceof Function&&(c=setTimeout(function(){a.apbct_external_onsubmit_prev.call(a,i)},500),clearTimeout(c));var c=a.querySelector('input[type="submit"]');if(c)return void c.click()}void 0!==e.apbct&&+e.apbct.blocked&&ctParseBlockMessage(e)}})}function apbctVal(e){return e.options&&e.multiple?e.options.filter(e=>e.selected).map(e=>e.value):"checkbox"===e.type||"radio"===e.type?e.checked||null:e.value}function ctCheckInternal(t){var e={},n=t.elements;let o;for(o in n)"submit"!==n[o].type&&void 0!==n[o].value&&""!==n[o].value&&(e[n[o].name]=t.elements[o].value);e.action="ct_check_internal",apbct_public_sendAJAX(e,{url:ctPublicFunctions._ajax_url,callback:function(e){if(!0!==e.success)return alert(e.data),!1;t.origSubmit()}})}function ctCheckInternalIsExcludedForm(t){return["wp-login.php","wp-comments-post.php"].some(e=>null!==t.match(new RegExp(ctPublic.blog_home+".*"+e)))}document.addEventListener("DOMContentLoaded",function(){let n="",o="";+ctPublic.settings__forms__check_internal&&setTimeout(()=>{for(let e=0;e<document.forms.length;e++){var t;"string"==typeof document.forms[e].action&&(o=document.forms[e],null===(n=o.action).indexOf("https?://")||null===n.match(ctPublic.blog_home+".*?.php")||ctCheckInternalIsExcludedForm(n)||(t=o.cloneNode(!0),o.parentNode.replaceChild(t,o),t.origSubmit=o.submit,t.submit=null,t.addEventListener("submit",function(e){return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),ctCheckInternal(e.target),!1})))}},500)});
//# sourceMappingURL=apbct-public-bundle_full-protection.min.js.map

{"version":3,"file":"apbct-public--functions.min.js","sources":["apbct-public--functions.js"],"sourcesContent":["function ctSetCookie( cookies, value, expires ){\n\n    if( typeof cookies === 'string' && typeof value === 'string' || typeof value === 'number'){\n        var skip_alt = cookies === 'ct_pointer_data';\n        cookies = [ [ cookies, value, expires ] ];\n    }\n\n    // Cookies disabled\n    if( ctPublicFunctions.data__cookies_type === 'none' ){\n        return;\n\n        // Using traditional cookies\n    }else if( ctPublicFunctions.data__cookies_type === 'native' ){\n        cookies.forEach( function (item, i, arr\t) {\n            var expires = typeof item[2] !== 'undefined' ? \"expires=\" + expires + '; ' : '';\n            var ctSecure = location.protocol === 'https:' ? '; secure' : '';\n            document.cookie = ctPublicFunctions.cookiePrefix + item[0] + \"=\" + encodeURIComponent(item[1]) + \"; \" + expires + \"path=/; samesite=lax\" + ctSecure;\n        });\n\n        // Using alternative cookies\n    }else if( ctPublicFunctions.data__cookies_type === 'alternative' && ! skip_alt ){\n\n        // Using REST API handler\n        if( ctPublicFunctions.data__ajax_type === 'rest' ){\n            apbct_public_sendREST(\n                'alt_sessions',\n                {\n                    method: 'POST',\n                    data: { cookies: cookies }\n                }\n            );\n\n        // Using AJAX request and handler\n        } else if( ctPublicFunctions.data__ajax_type === 'admin_ajax' ) {\n            apbct_public_sendAJAX(\n                {\n                    action: 'apbct_alt_session__save__AJAX',\n                    cookies: cookies,\n                },\n                {\n                    notJson: 1,\n                }\n            );\n        }\n    }\n}\n\nfunction ctDeleteCookie(cookieName) {\n    // Cookies disabled\n    if( ctPublicFunctions.data__cookies_type === 'none' ){\n        return;\n\n    // Using traditional cookies\n    }else if( ctPublicFunctions.data__cookies_type === 'native' ){\n\n        var ctSecure = location.protocol === 'https:' ? '; secure' : '';\n        document.cookie = cookieName + \"=\\\"\\\"; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; samesite=lax\" + ctSecure;\n\n    // Using alternative cookies\n    }else if( ctPublicFunctions.data__cookies_type === 'alternative' ){\n        // @ToDo implement this logic\n    }\n}\n\nfunction apbct_public_sendAJAX(data, params, obj){\n\n    // Default params\n    var callback    = params.callback    || null;\n    var callback_context = params.callback_context || null;\n    var callback_params = params.callback_params || null;\n    var async = params.async || true;\n    var notJson     = params.notJson     || null;\n    var timeout     = params.timeout     || 15000;\n    var obj         = obj                || null;\n    var button      = params.button      || null;\n    var spinner     = params.spinner     || null;\n    var progressbar = params.progressbar || null;\n    var silent      = params.silent      || null;\n    var no_nonce    = params.no_nonce    || null;\n\n    if(typeof (data) === 'string') {\n        if( ! no_nonce )\n            data = data + '&_ajax_nonce=' + ctPublicFunctions._ajax_nonce;\n        data = data + '&no_cache=' + Math.random()\n    } else {\n        if( ! no_nonce )\n            data._ajax_nonce = ctPublicFunctions._ajax_nonce;\n        data.no_cache = Math.random();\n    }\n    // Button and spinner\n    if(button)  {button.setAttribute('disabled', 'disabled'); button.style.cursor = 'not-allowed'; }\n    if(spinner) jQuery(spinner).css('display', 'inline');\n\n    jQuery.ajax({\n        type: \"POST\",\n        url: ctPublicFunctions._ajax_url,\n        data: data,\n        async: async,\n        success: function(result){\n            if(button){  button.removeAttribute('disabled'); button.style.cursor = 'pointer'; }\n            if(spinner)  jQuery(spinner).css('display', 'none');\n            if(!notJson) result = JSON.parse(result);\n            if(result.error){\n                setTimeout(function(){ if(progressbar) progressbar.fadeOut('slow'); }, 1000);\n                console.log('Error happens: ' + (result.error || 'Unkown'));\n            }else{\n                if(callback) {\n                    if (callback_params)\n                        callback.apply( callback_context, callback_params.concat( result, data, params, obj ) );\n                    else\n                        callback(result, data, params, obj);\n                }\n            }\n        },\n        error: function(jqXHR, textStatus, errorThrown){\n            if(button){  button.removeAttribute('disabled'); button.style.cursor = 'pointer'; }\n            if(spinner) jQuery(spinner).css('display', 'none');\n            if( errorThrown && ! silent ) {\n                console.log('APBCT_AJAX_ERROR');\n                console.log(jqXHR);\n                console.log(textStatus);\n                console.log('Anti-spam by Cleantalk plugin error: ' + errorThrown + 'Please, contact Cleantalk tech support https://wordpress.org/support/plugin/cleantalk-spam-protect/');\n            }\n        },\n        timeout: timeout,\n    });\n}\n\nfunction apbct_public_sendREST( route, params ) {\n\n    var callback = params.callback || null;\n    var data     = params.data || [];\n    var method   = params.method || 'POST';\n\n    jQuery.ajax({\n        type: method,\n        url: ctPublicFunctions._rest_url + 'cleantalk-antispam/v1/' + route,\n        data: data,\n        beforeSend : function ( xhr ) {\n            xhr.setRequestHeader( 'X-WP-Nonce', ctPublicFunctions._rest_nonce );\n        },\n        success: function(result){\n            if(result.error){\n                console.log('Error happens: ' + (result.error || 'Unknown'));\n            }else{\n                if(callback) {\n                    var obj = null;\n                    callback(result, route, params, obj);\n                }\n            }\n        },\n        error: function(jqXHR, textStatus, errorThrown){\n            if( errorThrown ) {\n                console.log('APBCT_REST_ERROR');\n                console.log(jqXHR);\n                console.log(textStatus);\n                console.log('Anti-spam by Cleantalk plugin REST API error: ' + errorThrown + ' Please, contact Cleantalk tech support https://wordpress.org/support/plugin/cleantalk-spam-protect/');\n            }\n        },\n    });\n}\n\napbctLocalStorage = {\n    get : function(key, property) {\n        if ( typeof property === 'undefined' ) {\n            property = 'value';\n        }\n        const storageValue = localStorage.getItem(key);\n        if ( storageValue !== null ) {\n            try {\n                const json = JSON.parse(storageValue);\n                return json.hasOwnProperty(property) ? JSON.parse(json[property]) : json;\n            } catch (e) {\n                return new Error(e);\n            }\n        }\n        return false;\n    },\n    set : function(key, value) {\n        let objToSave = {'value': JSON.stringify(value), 'timestamp': Math.floor(new Date().getTime() / 1000)};\n        localStorage.setItem(key, JSON.stringify(objToSave));\n    },\n    isAlive : function(key, maxLifetime) {\n        if ( typeof maxLifetime === 'undefined' ) {\n            maxLifetime = 86400;\n        }\n        const keyTimestamp = this.get(key, 'timestamp');\n        return keyTimestamp + maxLifetime > Math.floor(new Date().getTime() / 1000);\n    },\n    isSet : function(key) {\n        return localStorage.getItem(key) !== null;\n    }\n}\nvar ct_date = new Date(),\n\tctTimeMs = new Date().getTime(),\n\tctMouseEventTimerFlag = true, //Reading interval flag\n\tctMouseData = [],\n\tctMouseDataCounter = 0,\n\tctCheckedEmails = {};\n\nfunction apbct_attach_event_handler(elem, event, callback){\n\tif(typeof window.addEventListener === \"function\") elem.addEventListener(event, callback);\n\telse                                              elem.attachEvent(event, callback);\n}\n\nfunction apbct_remove_event_handler(elem, event, callback){\n\tif(typeof window.removeEventListener === \"function\") elem.removeEventListener(event, callback);\n\telse                                                 elem.detachEvent(event, callback);\n}\n\n//Writing first key press timestamp\nvar ctFunctionFirstKey = function output(event){\n\tvar KeyTimestamp = Math.floor(new Date().getTime()/1000);\n\tctSetCookie(\"ct_fkp_timestamp\", KeyTimestamp);\n\tctKeyStopStopListening();\n};\n\n//Reading interval\nvar ctMouseReadInterval = setInterval(function(){\n\tctMouseEventTimerFlag = true;\n}, 150);\n\n//Writting interval\nvar ctMouseWriteDataInterval = setInterval(function(){\n\tctSetCookie(\"ct_pointer_data\", JSON.stringify(ctMouseData));\n}, 1200);\n\n//Logging mouse position each 150 ms\nvar ctFunctionMouseMove = function output(event){\n\tctSetMouseMoved();\n\tif(ctMouseEventTimerFlag === true){\n\n\t\tctMouseData.push([\n\t\t\tMath.round(event.clientY),\n\t\t\tMath.round(event.clientX),\n\t\t\tMath.round(new Date().getTime() - ctTimeMs)\n\t\t]);\n\n\t\tctMouseDataCounter++;\n\t\tctMouseEventTimerFlag = false;\n\t\tif(ctMouseDataCounter >= 50){\n\t\t\tctMouseStopData();\n\t\t}\n\t}\n};\n\n//Stop mouse observing function\nfunction ctMouseStopData(){\n\tapbct_remove_event_handler(window, \"mousemove\", ctFunctionMouseMove);\n\tclearInterval(ctMouseReadInterval);\n\tclearInterval(ctMouseWriteDataInterval);\n}\n\n//Stop key listening function\nfunction ctKeyStopStopListening(){\n\tapbct_remove_event_handler(window, \"mousedown\", ctFunctionFirstKey);\n\tapbct_remove_event_handler(window, \"keydown\", ctFunctionFirstKey);\n}\n\nfunction checkEmail(e) {\n\tvar current_email = e.target.value;\n\tif (current_email && !(current_email in ctCheckedEmails)) {\n\t\t// Using REST API handler\n\t\tif( ctPublicFunctions.data__ajax_type === 'rest' ){\n\t\t\tapbct_public_sendREST(\n\t\t\t\t'check_email_before_post',\n\t\t\t\t{\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {'email' : current_email},\n\t\t\t\t\tcallback: function (result) {\n\t\t\t\t\t\tif (result.result) {\n\t\t\t\t\t\t\tctCheckedEmails[current_email] = {'result' : result.result, 'timestamp': Date.now() / 1000 |0};\n\t\t\t\t\t\t\tctSetCookie('ct_checked_emails', JSON.stringify(ctCheckedEmails));\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t\t// Using AJAX request and handler\n\t\t} else if( ctPublicFunctions.data__ajax_type === 'admin_ajax' ) {\n\t\t\tapbct_public_sendAJAX(\n\t\t\t\t{\n\t\t\t\t\taction: 'apbct_email_check_before_post',\n\t\t\t\t\temail : current_email,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcallback: function (result) {\n\t\t\t\t\t\tif (result.result) {\n\t\t\t\t\t\t\tctCheckedEmails[current_email] = {'result' : result.result, 'timestamp': Date.now() / 1000 |0};\n\t\t\t\t\t\t\tctSetCookie('ct_checked_emails', JSON.stringify(ctCheckedEmails));\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n}\n\nfunction ctSetPixelImg(pixelUrl) {\n\tctSetCookie('apbct_pixel_url', pixelUrl);\n\tif( +ctPublic.pixel__enabled ){\n\t\tif( ! document.getElementById('apbct_pixel') ) {\n\t\t\tjQuery('body').append( '<img alt=\"Cleantalk Pixel\" id=\"apbct_pixel\" style=\"display: none; left: 99999px;\" src=\"' + pixelUrl + '\">' );\n\t\t}\n\t}\n}\n\nfunction ctGetPixelUrl() {\n\t// Check if pixel is already in localstorage and is not outdated\n\tlet local_storage_pixel_url = ctGetPixelUrlLocalstorage();\n\tif ( local_storage_pixel_url !== false ) {\n\t\tif ( ctIsOutdatedPixelUrlLocalstorage(local_storage_pixel_url) ) {\n\t\t\tctCleaPixelUrlLocalstorage(local_storage_pixel_url)\n\t\t} else {\n\t\t\t//if so - load pixel from localstorage and draw it skipping AJAX\n\t\t\tctSetPixelImg(local_storage_pixel_url);\n\t\t\treturn;\n\t\t}\n\t}\n\t// Using REST API handler\n\tif( ctPublicFunctions.data__ajax_type === 'rest' ){\n\t\tapbct_public_sendREST(\n\t\t\t'apbct_get_pixel_url',\n\t\t\t{\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcallback: function (result) {\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\t//set  pixel url to localstorage\n\t\t\t\t\t\tif ( ! ctGetPixelUrlLocalstorage() ){\n\t\t\t\t\t\t\tctSetPixelUrlLocalstorage(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//then run pixel drawing\n\t\t\t\t\t\tctSetPixelImg(result);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t\t// Using AJAX request and handler\n\t}else{\n\t\tapbct_public_sendAJAX(\n\t\t\t{\n\t\t\t\taction: 'apbct_get_pixel_url',\n\t\t\t},\n\t\t\t{\n\t\t\t\tnotJson: true,\n\t\t\t\tcallback: function (result) {\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\t//set  pixel url to localstorage\n\t\t\t\t\t\tif ( ! ctGetPixelUrlLocalstorage() ){\n\t\t\t\t\t\t\tctSetPixelUrlLocalstorage(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//then run pixel drawing\n\t\t\t\t\t\tctSetPixelImg(result);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n}\n\nfunction ctSetHasScrolled() {\n\tif( ! apbctLocalStorage.isSet('ct_has_scrolled') || ! apbctLocalStorage.get('ct_has_scrolled') ) {\n\t\tctSetCookie(\"ct_has_scrolled\", 'true');\n\t\tapbctLocalStorage.set('ct_has_scrolled', true);\n\t}\n}\n\nfunction ctSetMouseMoved() {\n\tif( ! apbctLocalStorage.isSet('ct_mouse_moved') || ! apbctLocalStorage.get('ct_mouse_moved') ) {\n\t\tctSetCookie(\"ct_mouse_moved\", 'true');\n\t\tapbctLocalStorage.set('ct_mouse_moved', true);\n\t}\n}\n\napbct_attach_event_handler(window, \"mousemove\", ctFunctionMouseMove);\napbct_attach_event_handler(window, \"mousedown\", ctFunctionFirstKey);\napbct_attach_event_handler(window, \"keydown\", ctFunctionFirstKey);\napbct_attach_event_handler(window, \"scroll\", ctSetHasScrolled);\n\n// Ready function\nfunction apbct_ready(){\n\n\t// Collect scrolling info\n\tvar initCookies = [\n\t\t[\"ct_ps_timestamp\", Math.floor(new Date().getTime() / 1000)],\n\t\t[\"ct_fkp_timestamp\", \"0\"],\n\t\t[\"ct_pointer_data\", \"0\"],\n\t\t[\"ct_timezone\", ct_date.getTimezoneOffset()/60*(-1) ],\n\t\t[\"ct_screen_info\", apbctGetScreenInfo()],\n\t\t[\"apbct_headless\", navigator.webdriver],\n\t];\n\n\tif( ctPublic.data__cookies_type !== 'native' ) {\n\t\tinitCookies.push(['apbct_visible_fields', '0']);\n\t} else {\n\t\t// Delete all visible fields cookies on load the page\n\t\tvar cookiesArray = document.cookie.split(\";\");\n\t\tif( cookiesArray.length !== 0 ) {\n\t\t\tfor ( var i = 0; i < cookiesArray.length; i++ ) {\n\t\t\t\tvar currentCookie = cookiesArray[i].trim();\n\t\t\t\tvar cookieName = currentCookie.split(\"=\")[0];\n\t\t\t\tif( cookieName.indexOf(\"apbct_visible_fields_\") === 0 ) {\n\t\t\t\t\tctDeleteCookie(cookieName);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif( +ctPublic.pixel__setting ){\n\t\tif( +ctPublic.pixel__enabled ){\n\t\t\tctGetPixelUrl()\n\t\t} else {\n\t\t\tinitCookies.push(['apbct_pixel_url', ctPublic.pixel__url]);\n\t\t}\n\t}\n\n\tif ( +ctPublic.data__email_check_before_post) {\n\t\tinitCookies.push(['ct_checked_emails', '0']);\n\t\tjQuery(\"input[type = 'email'], #email\").blur(checkEmail);\n\t}\n\n\tctSetCookie(initCookies);\n\n\tsetTimeout(function(){\n\n\t\tfor(var i = 0; i < document.forms.length; i++){\n\t\t\tvar form = document.forms[i];\n\n\t\t\t//Exclusion for forms\n\t\t\tif (\n\t\t\t\t+ctPublic.data__visible_fields_required === 0 ||\n\t\t\t\tform.method.toString().toLowerCase() === 'get' ||\n\t\t\t\tform.classList.contains('slp_search_form') || //StoreLocatorPlus form\n\t\t\t\tform.parentElement.classList.contains('mec-booking') ||\n\t\t\t\tform.action.toString().indexOf('activehosted.com') !== -1 || // Active Campaign\n\t\t\t\t(form.id && form.id === 'caspioform') || //Caspio Form\n\t\t\t\t(form.classList && form.classList.contains('tinkoffPayRow')) || // TinkoffPayForm\n\t\t\t\t(form.classList && form.classList.contains('give-form')) || // GiveWP\n\t\t\t\t(form.id && form.id === 'ult-forgot-password-form') || //ult forgot password\n\t\t\t\t(form.id && form.id.toString().indexOf('calculatedfields') !== -1) || // CalculatedFieldsForm\n\t\t\t\t(form.id && form.id.toString().indexOf('sac-form') !== -1) || // Simple Ajax Chat\n\t\t\t\t(form.id && form.id.toString().indexOf('cp_tslotsbooking_pform') !== -1) || // WP Time Slots Booking Form\n\t\t\t\t(form.name && form.name.toString().indexOf('cp_tslotsbooking_pform') !== -1)  || // WP Time Slots Booking Form\n\t\t\t\tform.action.toString() === 'https://epayment.epymtservice.com/epay.jhtml' || // Custom form\n\t\t\t\t(form.name && form.name.toString().indexOf('tribe-bar-form') !== -1)  // The Events Calendar\n\t\t\t) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar hiddenInput = document.createElement( 'input' );\n\t\t\thiddenInput.setAttribute( 'type', 'hidden' );\n\t\t\thiddenInput.setAttribute( 'id', 'apbct_visible_fields_' + i );\n\t\t\thiddenInput.setAttribute( 'name', 'apbct_visible_fields');\n\t\t\tvar visibleFieldsToInput = {};\n\t\t\tvisibleFieldsToInput[0] = apbct_collect_visible_fields(form);\n\t\t\thiddenInput.value = JSON.stringify(visibleFieldsToInput);\n\t\t\tform.append( hiddenInput );\n\n\t\t\tform.onsubmit_prev = form.onsubmit;\n\n\t\t\tform.ctFormIndex = i;\n\t\t\tform.onsubmit = function (event) {\n\n\t\t\t\tif ( ctPublic.data__cookies_type !== 'native' && typeof event.target.ctFormIndex !== 'undefined' ) {\n\n\t\t\t\t\tvar visible_fields = {};\n\t\t\t\t\tvisible_fields[0] = apbct_collect_visible_fields(this);\n\t\t\t\t\tapbct_visible_fields_set_cookie( visible_fields, event.target.ctFormIndex );\n\t\t\t\t}\n\n\t\t\t\t// Call previous submit action\n\t\t\t\tif (event.target.onsubmit_prev instanceof Function) {\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\tevent.target.onsubmit_prev.call(event.target, event);\n\t\t\t\t\t}, 500);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t}, 1000);\n\n\t// Listen clicks on encoded emails\n\tlet decodedEmailNodes = document.querySelectorAll(\"[data-original-string]\");\n\tif (decodedEmailNodes.length) {\n\t\tfor (let i = 0; i < decodedEmailNodes.length; ++i) {\n\t\t\tif (\n\t\t\t\tdecodedEmailNodes[i].parentElement.href ||\n\t\t\t\tdecodedEmailNodes[i].parentElement.parentElement.href\n\t\t\t) {\n\t\t\t\t// Skip listening click on hyperlinks\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tdecodedEmailNodes[i].addEventListener('click', function ctFillDecodedEmailHandler(event) {\n\t\t\t\tthis.removeEventListener('click', ctFillDecodedEmailHandler);\n\t\t\t\tapbctAjaxEmailDecode(event);\n\t\t\t});\n\t\t}\n\t}\n}\napbct_attach_event_handler(window, \"DOMContentLoaded\", apbct_ready);\n\nfunction apbctAjaxEmailDecode(event){\n\tconst element = event.target;\n\telement.setAttribute('title', ctPublicFunctions.text__wait_for_decoding);\n\telement.style.cursor = 'progress';\n\t// Using REST API handler\n\tif( ctPublicFunctions.data__ajax_type === 'rest' ){\n\t\tapbct_public_sendREST(\n\t\t\t'apbct_decode_email',\n\t\t\t{\n\t\t\t\tdata: {encodedEmail: event.target.dataset.originalString},\n\t\t\t\tmethod: 'POST',\n\t\t\t\tcallback: function (result) {\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\tctFillDecodedEmail(result.data, event.target);\n\t\t\t\t\t\telement.setAttribute('title', '');\n\t\t\t\t\t\telement.removeAttribute('style');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t\t// Using AJAX request and handler\n\t}else{\n\t\tapbct_public_sendAJAX(\n\t\t\t{\n\t\t\t\taction: 'apbct_decode_email',\n\t\t\t\tencodedEmail: event.target.dataset.originalString\n\t\t\t},\n\t\t\t{\n\t\t\t\tnotJson: true,\n\t\t\t\tcallback: function (result) {\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\tctFillDecodedEmail(result.data, event.target);\n\t\t\t\t\t\telement.setAttribute('title', '');\n\t\t\t\t\t\telement.removeAttribute('style');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n}\n\nfunction ctFillDecodedEmail(result, targetElement){\n\ttargetElement.innerHTML = result;\n}\n\nfunction apbct_collect_visible_fields( form ) {\n\n\t// Get only fields\n\tvar inputs = [],\n\t\tinputs_visible = '',\n\t\tinputs_visible_count = 0,\n\t\tinputs_invisible = '',\n\t\tinputs_invisible_count = 0,\n\t\tinputs_with_duplicate_names = [];\n\n\tfor(var key in form.elements){\n\t\tif(!isNaN(+key))\n\t\t\tinputs[key] = form.elements[key];\n\t}\n\n\t// Filter fields\n\tinputs = inputs.filter(function(elem){\n\n\t\t// Filter already added fields\n\t\tif( inputs_with_duplicate_names.indexOf( elem.getAttribute('name') ) !== -1 ){\n\t\t\treturn false;\n\t\t}\n\t\t// Filter inputs with same names for type == radio\n\t\tif( -1 !== ['radio', 'checkbox'].indexOf( elem.getAttribute(\"type\") )){\n\t\t\tinputs_with_duplicate_names.push( elem.getAttribute('name') );\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\t// Visible fields\n\tinputs.forEach(function(elem, i, elements){\n\t\t// Unnecessary fields\n\t\tif(\n\t\t\telem.getAttribute(\"type\")         === \"submit\" || // type == submit\n\t\t\telem.getAttribute('name')         === null     ||\n\t\t\telem.getAttribute('name')         === 'ct_checkjs'\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\t// Invisible fields\n\t\tif(\n\t\t\tgetComputedStyle(elem).display    === \"none\" ||   // hidden\n\t\t\tgetComputedStyle(elem).visibility === \"hidden\" || // hidden\n\t\t\tgetComputedStyle(elem).opacity    === \"0\" ||      // hidden\n\t\t\telem.getAttribute(\"type\")         === \"hidden\" // type == hidden\n\t\t) {\n\t\t\tif( elem.classList.contains(\"wp-editor-area\") ) {\n\t\t\t\tinputs_visible += \" \" + elem.getAttribute(\"name\");\n\t\t\t\tinputs_visible_count++;\n\t\t\t} else {\n\t\t\t\tinputs_invisible += \" \" + elem.getAttribute(\"name\");\n\t\t\t\tinputs_invisible_count++;\n\t\t\t}\n\t\t}\n\t\t// Visible fields\n\t\telse {\n\t\t\tinputs_visible += \" \" + elem.getAttribute(\"name\");\n\t\t\tinputs_visible_count++;\n\t\t}\n\n\t});\n\n\tinputs_invisible = inputs_invisible.trim();\n\tinputs_visible = inputs_visible.trim();\n\n\treturn {\n\t\tvisible_fields : inputs_visible,\n\t\tvisible_fields_count : inputs_visible_count,\n\t\tinvisible_fields : inputs_invisible,\n\t\tinvisible_fields_count : inputs_invisible_count,\n\t}\n\n}\n\nfunction apbct_visible_fields_set_cookie( visible_fields_collection, form_id ) {\n\n\tvar collection = typeof visible_fields_collection === 'object' && visible_fields_collection !== null ?  visible_fields_collection : {};\n\n\tif( ctPublic.data__cookies_type === 'native' ) {\n\t\tfor ( var i in collection ) {\n\t\t\tif ( i > 10 ) {\n\t\t\t\t// Do not generate more than 10 cookies\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar collectionIndex = form_id !== undefined ? form_id : i;\n\t\t\tctSetCookie(\"apbct_visible_fields_\" + collectionIndex, JSON.stringify( collection[i] ) );\n\t\t}\n\t} else {\n\t\tctSetCookie(\"apbct_visible_fields\", JSON.stringify( collection ) );\n\t}\n}\n\nfunction apbct_js_keys__set_input_value(result, data, params, obj){\n\tif( document.querySelectorAll('[name^=ct_checkjs]').length > 0 ) {\n\t\tvar elements = document.querySelectorAll('[name^=ct_checkjs]');\n\t\tfor ( var i = 0; i < elements.length; i++ ) {\n\t\t\telements[i].value = result.js_key;\n\t\t}\n\t}\n}\n\nfunction apbctGetScreenInfo() {\n\treturn JSON.stringify({\n\t\tfullWidth : document.documentElement.scrollWidth,\n\t\tfullHeight : Math.max(\n\t\t\tdocument.body.scrollHeight, document.documentElement.scrollHeight,\n\t\t\tdocument.body.offsetHeight, document.documentElement.offsetHeight,\n\t\t\tdocument.body.clientHeight, document.documentElement.clientHeight\n\t\t),\n\t\tvisibleWidth : document.documentElement.clientWidth,\n\t\tvisibleHeight : document.documentElement.clientHeight,\n\t});\n}\n\nif(typeof jQuery !== 'undefined') {\n\n\t// Capturing responses and output block message for unknown AJAX forms\n\tjQuery(document).ajaxComplete(function (event, xhr, settings) {\n\t\tif (xhr.responseText && xhr.responseText.indexOf('\"apbct') !== -1) {\n\t\t\tvar response = JSON.parse(xhr.responseText);\n\t\t\tif (typeof response.apbct !== 'undefined') {\n\t\t\t\tresponse = response.apbct;\n\t\t\t\tif (response.blocked) {\n\t\t\t\t\tdocument.dispatchEvent(\n\t\t\t\t\t\tnew CustomEvent( \"apbctAjaxBockAlert\", {\n\t\t\t\t\t\t\tbubbles: true,\n\t\t\t\t\t\t\tdetail: { message: response.comment }\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\n\t\t\t\t\t// Show the result by modal\n\t\t\t\t\tcleantalkModal.loaded = response.comment;\n\t\t\t\t\tcleantalkModal.open();\n\n\t\t\t\t\tif(+response.stop_script == 1)\n\t\t\t\t\t\twindow.stop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction ctSetPixelUrlLocalstorage(ajax_pixel_url) {\n\t//set pixel to the storage\n\tlocalStorage.setItem('session_pixel_url', ajax_pixel_url)\n\t//set pixel timestamp to the storage\n\tlocalStorage.setItem(ajax_pixel_url, Math.floor(Date.now() / 1000).toString())\n}\n\nfunction ctGetPixelUrlLocalstorage() {\n\tlet local_storage_pixel = localStorage.getItem('session_pixel_url');\n\tif ( local_storage_pixel !== null ) {\n\t\treturn local_storage_pixel;\n\t} else {\n\t\treturn false;\n\t}\n}\n\nfunction ctIsOutdatedPixelUrlLocalstorage(local_storage_pixel_url) {\n\tlet local_storage_pixel_timestamp = Number(localStorage.getItem(local_storage_pixel_url));\n\tlet current_timestamp = Math.floor(Date.now() / 1000).toString()\n\tlet timestamp_difference = current_timestamp - local_storage_pixel_timestamp;\n\treturn timestamp_difference > 3600 * 3;\n}\n\nfunction ctCleaPixelUrlLocalstorage(local_storage_pixel_url) {\n\t//remove timestamp\n\tlocalStorage.removeItem(local_storage_pixel_url)\n\t//remove pixel itself\n\tlocalStorage.removeItem('session_pixel_url')\n}\n/* Cleantalk Modal object */\ncleantalkModal = {\n\n    // Flags\n    loaded: false,\n    loading: false,\n    opened: false,\n    opening: false,\n\n    // Methods\n    load: function( action ) {\n        if( ! this.loaded ) {\n            this.loading = true;\n            callback = function( result, data, params, obj ) {\n                cleantalkModal.loading = false;\n                cleantalkModal.loaded = result;\n                document.dispatchEvent(\n                    new CustomEvent( \"cleantalkModalContentLoaded\", {\n                        bubbles: true,\n                    } )\n                );\n            };\n            if( typeof apbct_admin_sendAJAX === \"function\" ) {\n                apbct_admin_sendAJAX( { 'action' : action }, { 'callback': callback, 'notJson': true } );\n            } else {\n                apbct_public_sendAJAX( { 'action' : action }, { 'callback': callback, 'notJson': true } );\n            }\n\n        }\n    },\n\n    open: function () {\n        /* Cleantalk Modal CSS start */\n        var renderCss = function () {\n            var cssStr = '';\n            for ( key in this.styles ) {\n                cssStr += key + ':' + this.styles[key] + ';';\n            }\n            return cssStr;\n        };\n        var overlayCss = {\n            styles: {\n                \"z-index\": \"9999\",\n                \"position\": \"fixed\",\n                \"top\": \"0\",\n                \"left\": \"0\",\n                \"width\": \"100%\",\n                \"height\": \"100%\",\n                \"background\": \"rgba(0,0,0,0.5)\",\n                \"display\": \"flex\",\n                \"justify-content\" : \"center\",\n                \"align-items\" : \"center\",\n            },\n            toString: renderCss\n        };\n        var innerCss = {\n            styles: {\n                \"position\" : \"relative\",\n                \"padding\" : \"30px\",\n                \"background\" : \"#FFF\",\n                \"border\" : \"1px solid rgba(0,0,0,0.75)\",\n                \"border-radius\" : \"4px\",\n                \"box-shadow\" : \"7px 7px 5px 0px rgba(50,50,50,0.75)\",\n            },\n            toString: renderCss\n        };\n        var closeCss = {\n            styles: {\n                \"position\" : \"absolute\",\n                \"background\" : \"#FFF\",\n                \"width\" : \"20px\",\n                \"height\" : \"20px\",\n                \"border\" : \"2px solid rgba(0,0,0,0.75)\",\n                \"border-radius\" : \"15px\",\n                \"cursor\" : \"pointer\",\n                \"top\" : \"-8px\",\n                \"right\" : \"-8px\",\n                \"box-sizing\" : \"content-box\",\n            },\n            toString: renderCss\n        };\n        var closeCssBefore = {\n            styles: {\n                \"content\" : \"\\\"\\\"\",\n                \"display\" : \"block\",\n                \"position\" : \"absolute\",\n                \"background\" : \"#000\",\n                \"border-radius\" : \"1px\",\n                \"width\" : \"2px\",\n                \"height\" : \"16px\",\n                \"top\" : \"2px\",\n                \"left\" : \"9px\",\n                \"transform\" : \"rotate(45deg)\",\n            },\n            toString: renderCss\n        };\n        var closeCssAfter = {\n            styles: {\n                \"content\" : \"\\\"\\\"\",\n                \"display\" : \"block\",\n                \"position\" : \"absolute\",\n                \"background\" : \"#000\",\n                \"border-radius\" : \"1px\",\n                \"width\" : \"2px\",\n                \"height\" : \"16px\",\n                \"top\" : \"2px\",\n                \"left\" : \"9px\",\n                \"transform\" : \"rotate(-45deg)\",\n            },\n            toString: renderCss\n        };\n        var bodyCss = {\n            styles: {\n                \"overflow\" : \"hidden\",\n            },\n            toString: renderCss\n        };\n        var cleantalkModalStyle = document.createElement( 'style' );\n        cleantalkModalStyle.setAttribute( 'id', 'cleantalk-modal-styles' );\n        cleantalkModalStyle.innerHTML = 'body.cleantalk-modal-opened{' + bodyCss + '}';\n        cleantalkModalStyle.innerHTML += '#cleantalk-modal-overlay{' + overlayCss + '}';\n        cleantalkModalStyle.innerHTML += '#cleantalk-modal-close{' + closeCss + '}';\n        cleantalkModalStyle.innerHTML += '#cleantalk-modal-close:before{' + closeCssBefore + '}';\n        cleantalkModalStyle.innerHTML += '#cleantalk-modal-close:after{' + closeCssAfter + '}';\n        document.body.append( cleantalkModalStyle );\n        /* Cleantalk Modal CSS end */\n\n        var overlay = document.createElement( 'div' );\n        overlay.setAttribute( 'id', 'cleantalk-modal-overlay' );\n        document.body.append( overlay );\n\n        document.body.classList.add( 'cleantalk-modal-opened' );\n\n        var inner = document.createElement( 'div' );\n        inner.setAttribute( 'id', 'cleantalk-modal-inner' );\n        inner.setAttribute( 'style', innerCss );\n        overlay.append( inner );\n\n        var close = document.createElement( 'div' );\n        close.setAttribute( 'id', 'cleantalk-modal-close' );\n        inner.append( close );\n\n        var content = document.createElement( 'div' );\n        if ( this.loaded ) {\n            content.innerHTML = this.loaded;\n        } else {\n            content.innerHTML = 'Loading...';\n            // @ToDo Here is hardcoded parameter. Have to get this from a 'data-' attribute.\n            this.load( 'get_options_template' );\n        }\n        content.setAttribute( 'id', 'cleantalk-modal-content' );\n        inner.append( content );\n\n        this.opened = true;\n    },\n\n    close: function () {\n        document.body.classList.remove( 'cleantalk-modal-opened' );\n        document.getElementById( 'cleantalk-modal-overlay' ).remove();\n        document.getElementById( 'cleantalk-modal-styles' ).remove();\n        document.dispatchEvent(\n            new CustomEvent( \"cleantalkModalClosed\", {\n                bubbles: true,\n            } )\n        );\n    }\n\n};\n\n/* Cleantalk Modal helpers */\ndocument.addEventListener('click',function( e ){\n    if( e.target && e.target.id === 'cleantalk-modal-overlay' || e.target.id === 'cleantalk-modal-close' ){\n        cleantalkModal.close();\n    }\n});\ndocument.addEventListener(\"cleantalkModalContentLoaded\", function( e ) {\n    if( cleantalkModal.opened && cleantalkModal.loaded ) {\n        document.getElementById( 'cleantalk-modal-content' ).innerHTML = cleantalkModal.loaded;\n    }\n});"],"names":["ctSetCookie","cookies","value","expires","skip_alt","ctPublicFunctions","data__cookies_type","forEach","item","i","arr","ctSecure","location","protocol","document","cookie","cookiePrefix","encodeURIComponent","data__ajax_type","apbct_public_sendREST","method","data","apbct_public_sendAJAX","action","notJson","ctDeleteCookie","cookieName","params","obj","callback","callback_context","callback_params","async","timeout","button","spinner","progressbar","silent","no_nonce","_ajax_nonce","Math","random","no_cache","setAttribute","style","cursor","jQuery","css","ajax","type","url","_ajax_url","success","result","removeAttribute","JSON","parse","error","setTimeout","fadeOut","console","log","apply","concat","jqXHR","textStatus","errorThrown","route","_rest_url","beforeSend","xhr","setRequestHeader","_rest_nonce","apbctLocalStorage","get","key","property","storageValue","localStorage","getItem","json","hasOwnProperty","e","Error","set","objToSave","stringify","timestamp","floor","Date","getTime","setItem","isAlive","maxLifetime","this","isSet","ct_date","ctTimeMs","ctMouseEventTimerFlag","ctMouseData","ctMouseDataCounter","ctCheckedEmails","apbct_attach_event_handler","elem","event","window","addEventListener","attachEvent","apbct_remove_event_handler","removeEventListener","detachEvent","ctFunctionFirstKey","ctKeyStopStopListening","ctMouseReadInterval","setInterval","ctMouseWriteDataInterval","ctFunctionMouseMove","ctSetMouseMoved","push","round","clientY","clientX","ctMouseStopData","clearInterval","checkEmail","current_email","target","email","now","ctSetPixelImg","pixelUrl","ctPublic","pixel__enabled","getElementById","append","ctGetPixelUrl","let","local_storage_pixel_url","ctGetPixelUrlLocalstorage","ctIsOutdatedPixelUrlLocalstorage","ctCleaPixelUrlLocalstorage","ctSetPixelUrlLocalstorage","ctSetHasScrolled","apbct_ready","initCookies","getTimezoneOffset","apbctGetScreenInfo","navigator","webdriver","cookiesArray","split","length","trim","indexOf","pixel__setting","pixel__url","data__email_check_before_post","blur","forms","hiddenInput","visibleFieldsToInput","form","data__visible_fields_required","toString","toLowerCase","classList","contains","parentElement","id","name","createElement","apbct_collect_visible_fields","onsubmit_prev","onsubmit","ctFormIndex","visible_fields","apbct_visible_fields_set_cookie","Function","call","decodedEmailNodes","querySelectorAll","href","ctFillDecodedEmailHandler","apbctAjaxEmailDecode","element","text__wait_for_decoding","encodedEmail","dataset","originalString","ctFillDecodedEmail","targetElement","innerHTML","inputs","inputs_visible","inputs_visible_count","inputs_invisible","inputs_invisible_count","inputs_with_duplicate_names","elements","isNaN","filter","getAttribute","getComputedStyle","display","visibility","opacity","visible_fields_count","invisible_fields","invisible_fields_count","visible_fields_collection","form_id","collection","undefined","apbct_js_keys__set_input_value","js_key","fullWidth","documentElement","scrollWidth","fullHeight","max","body","scrollHeight","offsetHeight","clientHeight","visibleWidth","clientWidth","visibleHeight","ajax_pixel_url","local_storage_pixel","local_storage_pixel_timestamp","Number","removeItem","ajaxComplete","settings","responseText","response","apbct","blocked","dispatchEvent","CustomEvent","bubbles","detail","message","comment","cleantalkModal","loaded","open","stop_script","stop","loading","opened","opening","load","apbct_admin_sendAJAX","renderCss","cssStr","styles","overlayCss","z-index","position","top","left","width","height","background","justify-content","align-items","innerCss","padding","border","border-radius","box-shadow","closeCss","right","box-sizing","closeCssBefore","content","transform","closeCssAfter","bodyCss","overflow","cleantalkModalStyle","overlay","inner","add","close","remove"],"mappings":"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"}
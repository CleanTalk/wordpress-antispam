{"version":3,"file":"apbct-fingerprint.min.js","sources":["apbct-fingerprint.js"],"sourcesContent":["/*\n* fingerprintJS 0.5.5 - Fast browser fingerprint library\n* https://github.com/Valve/fingerprintjs\n* Copyright (c) 2013 Valentin Vasilyev (valentin.vasilyev@outlook.com)\n* Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n* AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n* ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY\n* DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n* LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n* ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n* THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n;(function (name, context, definition) {\n  if (typeof module !== 'undefined' && module.exports) { module.exports = definition(); }\n  else if (typeof define === 'function' && define.amd) { define(definition); }\n  else { context[name] = definition(); }\n})('Fingerprint', this, function () {\n  'use strict';\n\n  var Fingerprint = function (options) {\n    var nativeForEach, nativeMap;\n    nativeForEach = Array.prototype.forEach;\n    nativeMap = Array.prototype.map;\n\n    this.each = function (obj, iterator, context) {\n      if (obj === null) {\n        return;\n      }\n      if (nativeForEach && obj.forEach === nativeForEach) {\n        obj.forEach(iterator, context);\n      } else if (obj.length === +obj.length) {\n        for (var i = 0, l = obj.length; i < l; i++) {\n          if (iterator.call(context, obj[i], i, obj) === {}) return;\n        }\n      } else {\n        for (var key in obj) {\n          if (obj.hasOwnProperty(key)) {\n            if (iterator.call(context, obj[key], key, obj) === {}) return;\n          }\n        }\n      }\n    };\n\n    this.map = function(obj, iterator, context) {\n      var results = [];\n      // Not using strict equality so that this acts as a\n      // shortcut to checking for `null` and `undefined`.\n      if (obj == null) return results;\n      if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);\n      this.each(obj, function(value, index, list) {\n        results[results.length] = iterator.call(context, value, index, list);\n      });\n      return results;\n    };\n\n    if (typeof options == 'object'){\n      this.hasher = options.hasher;\n      this.screen_resolution = options.screen_resolution;\n      this.screen_orientation = options.screen_orientation;\n      this.canvas = options.canvas;\n      this.ie_activex = options.ie_activex;\n    } else if(typeof options == 'function'){\n      this.hasher = options;\n    }\n  };\n\n  Fingerprint.prototype = {\n    get: function(){\n      var keys = [];\n      keys.push(navigator.userAgent);\n      keys.push(navigator.language);\n      keys.push(screen.colorDepth);\n      if (this.screen_resolution) {\n        var resolution = this.getScreenResolution();\n        if (typeof resolution !== 'undefined'){ // headless browsers, such as phantomjs\n          keys.push(resolution.join('x'));\n        }\n      }\n      keys.push(new Date().getTimezoneOffset());\n      keys.push(this.hasSessionStorage());\n      keys.push(this.hasLocalStorage());\n      keys.push(this.hasIndexDb());\n      //body might not be defined at this point or removed programmatically\n      if(document.body){\n        keys.push(typeof(document.body.addBehavior));\n      } else {\n        keys.push(typeof undefined);\n      }\n      keys.push(typeof(window.openDatabase));\n      keys.push(navigator.cpuClass);\n      keys.push(navigator.platform);\n      keys.push(navigator.doNotTrack);\n      keys.push(this.getPluginsString());\n      if(this.canvas && this.isCanvasSupported()){\n        keys.push(this.getCanvasFingerprint());\n      }\n      if(this.hasher){\n        return this.hasher(keys.join('###'), 31);\n      } else {\n        return this.murmurhash3_32_gc(keys.join('###'), 31);\n      }\n    },\n\n    /**\n     * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\n     *\n     * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n     * @see http://github.com/garycourt/murmurhash-js\n     * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n     * @see http://sites.google.com/site/murmurhash/\n     *\n     * @param {string} key ASCII only\n     * @param {number} seed Positive integer only\n     * @return {number} 32-bit positive integer hash\n     */\n\n    murmurhash3_32_gc: function(key, seed) {\n      var remainder, bytes, h1, h1b, c1, c2, k1, i;\n\n      remainder = key.length & 3; // key.length % 4\n      bytes = key.length - remainder;\n      h1 = seed;\n      c1 = 0xcc9e2d51;\n      c2 = 0x1b873593;\n      i = 0;\n\n      while (i < bytes) {\n          k1 =\n            ((key.charCodeAt(i) & 0xff)) |\n            ((key.charCodeAt(++i) & 0xff) << 8) |\n            ((key.charCodeAt(++i) & 0xff) << 16) |\n            ((key.charCodeAt(++i) & 0xff) << 24);\n        ++i;\n\n        k1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\n        k1 = (k1 << 15) | (k1 >>> 17);\n        k1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\n\n        h1 ^= k1;\n            h1 = (h1 << 13) | (h1 >>> 19);\n        h1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\n        h1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\n      }\n\n      k1 = 0;\n\n      switch (remainder) {\n        case 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\n        case 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\n        case 1: k1 ^= (key.charCodeAt(i) & 0xff);\n\n        k1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\n        k1 = (k1 << 15) | (k1 >>> 17);\n        k1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\n        h1 ^= k1;\n      }\n\n      h1 ^= key.length;\n\n      h1 ^= h1 >>> 16;\n      h1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\n      h1 ^= h1 >>> 13;\n      h1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\n      h1 ^= h1 >>> 16;\n\n      return h1 >>> 0;\n    },\n\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=781447\n    hasLocalStorage: function () {\n      try{\n        return !!window.localStorage;\n      } catch(e) {\n        return true; // SecurityError when referencing it means it exists\n      }\n    },\n\n    hasSessionStorage: function () {\n      try{\n        return !!window.sessionStorage;\n      } catch(e) {\n        return true; // SecurityError when referencing it means it exists\n      }\n    },\n\n    hasIndexDb: function () {\n      try{\n        return !!window.indexedDB;\n      } catch(e) {\n        return true; // SecurityError when referencing it means it exists\n      }\n    },\n\n    isCanvasSupported: function () {\n      var elem = document.createElement('canvas');\n      return !!(elem.getContext && elem.getContext('2d'));\n    },\n\n    isIE: function () {\n      if(navigator.appName === 'Microsoft Internet Explorer') {\n        return true;\n      } else if(navigator.appName === 'Netscape' && /Trident/.test(navigator.userAgent)){// IE 11\n        return true;\n      }\n      return false;\n    },\n\n    getPluginsString: function () {\n      if(this.isIE() && this.ie_activex){\n        return this.getIEPluginsString();\n      } else {\n        return this.getRegularPluginsString();\n      }\n    },\n\n    getRegularPluginsString: function () {\n      return this.map(navigator.plugins, function (p) {\n        var mimeTypes = this.map(p, function(mt){\n          return [mt.type, mt.suffixes].join('~');\n        }).join(',');\n        return [p.name, p.description, mimeTypes].join('::');\n      }, this).join(';');\n    },\n\n    getIEPluginsString: function () {\n      if(window.ActiveXObject){\n        var names = ['ShockwaveFlash.ShockwaveFlash',//flash plugin\n          'AcroPDF.PDF', // Adobe PDF reader 7+\n          'PDF.PdfCtrl', // Adobe PDF reader 6 and earlier, brrr\n          'QuickTime.QuickTime', // QuickTime\n          // 5 versions of real players\n          'rmocx.RealPlayer G2 Control',\n          'rmocx.RealPlayer G2 Control.1',\n          'RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)',\n          'RealVideo.RealVideo(tm) ActiveX Control (32-bit)',\n          'RealPlayer',\n          'SWCtl.SWCtl', // ShockWave player\n          'WMPlayer.OCX', // Windows media player\n          'AgControl.AgControl', // Silverlight\n          'Skype.Detection'];\n\n        // starting to detect plugins in IE\n        return this.map(names, function(name){\n          try{\n            new ActiveXObject(name);\n            return name;\n          } catch(e){\n            return null;\n          }\n        }).join(';');\n      } else {\n        return \"\"; // behavior prior version 0.5.0, not breaking backwards compat.\n      }\n    },\n\n    getScreenResolution: function () {\n      var resolution;\n       if(this.screen_orientation){\n         resolution = (screen.height > screen.width) ? [screen.height, screen.width] : [screen.width, screen.height];\n       }else{\n         resolution = [screen.height, screen.width];\n       }\n       return resolution;\n    },\n\n    getCanvasFingerprint: function () {\n      var canvas = document.createElement('canvas');\n      var ctx = canvas.getContext('2d');\n      // https://www.browserleaks.com/canvas#how-does-it-work\n      var txt = 'http://valve.github.io';\n      ctx.textBaseline = \"top\";\n      ctx.font = \"14px 'Arial'\";\n      ctx.textBaseline = \"alphabetic\";\n      ctx.fillStyle = \"#f60\";\n      ctx.fillRect(125,1,62,20);\n      ctx.fillStyle = \"#069\";\n      ctx.fillText(txt, 2, 15);\n      ctx.fillStyle = \"rgba(102, 204, 0, 0.7)\";\n      ctx.fillText(txt, 4, 17);\n      return canvas.toDataURL();\n    }\n  };\n\n\n  return Fingerprint;\n\n});"],"names":["context","definition","module","exports","define","amd","this","Fingerprint","options","nativeForEach","Array","prototype","forEach","nativeMap","map","each","obj","iterator","length","i","l","call","key","hasOwnProperty","results","value","index","list","hasher","screen_resolution","screen_orientation","canvas","ie_activex","get","resolution","keys","push","navigator","userAgent","language","screen","colorDepth","getScreenResolution","join","Date","getTimezoneOffset","hasSessionStorage","hasLocalStorage","hasIndexDb","document","body","window","cpuClass","platform","doNotTrack","getPluginsString","isCanvasSupported","getCanvasFingerprint","murmurhash3_32_gc","seed","h1b","k1","remainder","bytes","h1","c1","c2","charCodeAt","localStorage","e","sessionStorage","indexedDB","elem","createElement","getContext","isIE","appName","test","getIEPluginsString","getRegularPluginsString","plugins","p","mimeTypes","mt","type","suffixes","name","description","ActiveXObject","height","width","ctx","txt","textBaseline","font","fillStyle","fillRect","fillText","toDataURL"],"mappings":"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"}
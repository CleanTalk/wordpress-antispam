{"version":3,"file":"apbct-public--3--cleantalk-modal.min.js","sources":["apbct-public--3--cleantalk-modal.js"],"sourcesContent":["/* Cleantalk Modal object */\nlet cleantalkModal = {\n\n    // Flags\n    loaded: false,\n    loading: false,\n    opened: false,\n    opening: false,\n\n    // Methods\n    load: function( action ) {\n        if( ! this.loaded ) {\n            this.loading = true;\n            let callback = function( result, data, params, obj ) {\n                cleantalkModal.loading = false;\n                cleantalkModal.loaded = result;\n                document.dispatchEvent(\n                    new CustomEvent( \"cleantalkModalContentLoaded\", {\n                        bubbles: true,\n                    } )\n                );\n            };\n            if( typeof apbct_admin_sendAJAX === \"function\" ) {\n                apbct_admin_sendAJAX( { 'action' : action }, { 'callback': callback, 'notJson': true } );\n            } else {\n                apbct_public_sendAJAX( { 'action' : action }, { 'callback': callback, 'notJson': true } );\n            }\n\n        }\n    },\n\n    open: function () {\n        /* Cleantalk Modal CSS start */\n        var renderCss = function () {\n            var cssStr = '';\n            for ( let key in this.styles ) {\n                cssStr += key + ':' + this.styles[key] + ';';\n            }\n            return cssStr;\n        };\n        var overlayCss = {\n            styles: {\n                \"z-index\": \"9999\",\n                \"position\": \"fixed\",\n                \"top\": \"0\",\n                \"left\": \"0\",\n                \"width\": \"100%\",\n                \"height\": \"100%\",\n                \"background\": \"rgba(0,0,0,0.5)\",\n                \"display\": \"flex\",\n                \"justify-content\" : \"center\",\n                \"align-items\" : \"center\",\n            },\n            toString: renderCss\n        };\n        var innerCss = {\n            styles: {\n                \"position\" : \"relative\",\n                \"padding\" : \"30px\",\n                \"background\" : \"#FFF\",\n                \"border\" : \"1px solid rgba(0,0,0,0.75)\",\n                \"border-radius\" : \"4px\",\n                \"box-shadow\" : \"7px 7px 5px 0px rgba(50,50,50,0.75)\",\n            },\n            toString: renderCss\n        };\n        var closeCss = {\n            styles: {\n                \"position\" : \"absolute\",\n                \"background\" : \"#FFF\",\n                \"width\" : \"20px\",\n                \"height\" : \"20px\",\n                \"border\" : \"2px solid rgba(0,0,0,0.75)\",\n                \"border-radius\" : \"15px\",\n                \"cursor\" : \"pointer\",\n                \"top\" : \"-8px\",\n                \"right\" : \"-8px\",\n                \"box-sizing\" : \"content-box\",\n            },\n            toString: renderCss\n        };\n        var closeCssBefore = {\n            styles: {\n                \"content\" : \"\\\"\\\"\",\n                \"display\" : \"block\",\n                \"position\" : \"absolute\",\n                \"background\" : \"#000\",\n                \"border-radius\" : \"1px\",\n                \"width\" : \"2px\",\n                \"height\" : \"16px\",\n                \"top\" : \"2px\",\n                \"left\" : \"9px\",\n                \"transform\" : \"rotate(45deg)\",\n            },\n            toString: renderCss\n        };\n        var closeCssAfter = {\n            styles: {\n                \"content\" : \"\\\"\\\"\",\n                \"display\" : \"block\",\n                \"position\" : \"absolute\",\n                \"background\" : \"#000\",\n                \"border-radius\" : \"1px\",\n                \"width\" : \"2px\",\n                \"height\" : \"16px\",\n                \"top\" : \"2px\",\n                \"left\" : \"9px\",\n                \"transform\" : \"rotate(-45deg)\",\n            },\n            toString: renderCss\n        };\n        var bodyCss = {\n            styles: {\n                \"overflow\" : \"hidden\",\n            },\n            toString: renderCss\n        };\n        var cleantalkModalStyle = document.createElement( 'style' );\n        cleantalkModalStyle.setAttribute( 'id', 'cleantalk-modal-styles' );\n        cleantalkModalStyle.innerHTML = 'body.cleantalk-modal-opened{' + bodyCss + '}';\n        cleantalkModalStyle.innerHTML += '#cleantalk-modal-overlay{' + overlayCss + '}';\n        cleantalkModalStyle.innerHTML += '#cleantalk-modal-close{' + closeCss + '}';\n        cleantalkModalStyle.innerHTML += '#cleantalk-modal-close:before{' + closeCssBefore + '}';\n        cleantalkModalStyle.innerHTML += '#cleantalk-modal-close:after{' + closeCssAfter + '}';\n        document.body.append( cleantalkModalStyle );\n        /* Cleantalk Modal CSS end */\n\n        var overlay = document.createElement( 'div' );\n        overlay.setAttribute( 'id', 'cleantalk-modal-overlay' );\n        document.body.append( overlay );\n\n        document.body.classList.add( 'cleantalk-modal-opened' );\n\n        var inner = document.createElement( 'div' );\n        inner.setAttribute( 'id', 'cleantalk-modal-inner' );\n        inner.setAttribute( 'style', innerCss );\n        overlay.append( inner );\n\n        var close = document.createElement( 'div' );\n        close.setAttribute( 'id', 'cleantalk-modal-close' );\n        inner.append( close );\n\n        var content = document.createElement( 'div' );\n        if ( this.loaded ) {\n            var urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n            var service_content_regex = /.*\\/inc/g;\n            if (service_content_regex.test(this.loaded)){\n                content.innerHTML = this.loaded\n            } else {\n                var renderedMsg = this.loaded.replace(urlRegex, '<a href=\"$1\" target=\"_blank\">$1</a>');\n                content.innerHTML = renderedMsg;\n            }\n\n        } else {\n            content.innerHTML = 'Loading...';\n            // @ToDo Here is hardcoded parameter. Have to get this from a 'data-' attribute.\n            this.load( 'get_options_template' );\n        }\n        content.setAttribute( 'id', 'cleantalk-modal-content' );\n        inner.append( content );\n\n        this.opened = true;\n    },\n\n    close: function () {\n        document.body.classList.remove( 'cleantalk-modal-opened' );\n        document.getElementById( 'cleantalk-modal-overlay' ).remove();\n        document.getElementById( 'cleantalk-modal-styles' ).remove();\n        document.dispatchEvent(\n            new CustomEvent( \"cleantalkModalClosed\", {\n                bubbles: true,\n            } )\n        );\n    }\n\n};\n\n/* Cleantalk Modal helpers */\ndocument.addEventListener('click',function( e ){\n    if( e.target && (e.target.id === 'cleantalk-modal-overlay' || e.target.id === 'cleantalk-modal-close') ){\n        cleantalkModal.close();\n    }\n});\ndocument.addEventListener(\"cleantalkModalContentLoaded\", function( e ) {\n    if( cleantalkModal.opened && cleantalkModal.loaded ) {\n        document.getElementById( 'cleantalk-modal-content' ).innerHTML = cleantalkModal.loaded;\n    }\n});"],"names":["let","cleantalkModal","loaded","loading","opened","opening","load","action","callback","this","result","data","params","obj","document","dispatchEvent","CustomEvent","bubbles","apbct_admin_sendAJAX","apbct_public_sendAJAX","notJson","open","renderCss","key","cssStr","styles","overlayCss","z-index","position","top","left","width","height","background","display","justify-content","align-items","toString","innerCss","padding","border","border-radius","box-shadow","closeCss","cursor","right","box-sizing","closeCssBefore","content","transform","closeCssAfter","bodyCss","overflow","cleantalkModalStyle","createElement","overlay","setAttribute","innerHTML","body","append","inner","classList","add","close","test","renderedMsg","replace","remove","getElementById","addEventListener","e","target","id"],"mappings":"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"}